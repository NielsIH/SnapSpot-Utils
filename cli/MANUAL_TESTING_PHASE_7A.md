# Phase 7A: CLI Foundation - Manual Testing Guide

**Status:** Ready for manual testing  
**Prerequisites:** Node.js 18+ installed, `npm install` completed  
**Location:** `cli/` directory  

## Automated Tests (Already Passing ✓)

All automated tests have passed:
```bash
cd cli
node test-all.js
```

**Results:**
- ✓ File Finder (2 .gitignore, 9 .json files found)
- ✓ Export Loader (loaded full-export.json successfully)
- ✓ Export Writer (all transformations working)
- ✓ Progress Bar (smooth animation, spinner, timed operations)
- ✓ Report Generator (text/JSON/HTML reports generated)

## Manual Testing Checklist

### 1. Verify HTML Report Rendering

**File:** `cli/test-report.html` (generated by automated tests)

**Steps:**
1. Open `cli/test-report.html` in a web browser
2. Verify the report displays correctly with:
   - ✓ Header with title and timestamp
   - ✓ Summary section with statistics (100 total files, 95 processed, 5 failed, 2m 15s duration)
   - ✓ Details table with file names, status, and sizes
   - ✓ Color coding (green for Success, red for Failed)
   - ✓ Embedded CSS (no external dependencies)

**Expected Result:**  
Report renders cleanly with proper styling and all data visible.

**Screenshot Location (optional):**  
Save screenshot to `cli/manual-test-screenshots/html-report.png`

---

### 2. Interactive Prompt Testing

**File:** `cli/test-prompt-helpers.js`

**Steps:**
1. Run the interactive test:
   ```bash
   cd cli
   node test-prompt-helpers.js
   ```

2. Follow the prompts and test each interaction:

**Prompt 1: File Selection**
- Use arrow keys to navigate
- Press Enter to select
- Verify selected file displays correctly
- ✓ Expected: File path shown after selection

**Prompt 2: Confirmation (Yes)**
- Arrow to "Yes", press Enter
- ✓ Expected: Confirmation message shown

**Prompt 3: Confirmation (No)**
- Arrow to "No", press Enter
- ✓ Expected: Cancellation message shown

**Prompt 4: Choice Selection**
- Navigate to "JSON" format
- Press Enter
- ✓ Expected: Selected format displayed

**Prompt 5: Directory Creation**
- **Option A:** Enter existing directory path (e.g., `./shared`)
  - ✓ Expected: Success message
- **Option B:** Enter non-existent directory path (e.g., `./test-output-dir`)
  - ✓ Expected: Prompt to create directory → confirm → directory created

**Prompt 6: Color Messages**
- Verify all 4 message types display:
  - ✓ Success message (green)
  - ✓ Error message (red)
  - ✓ Warning message (yellow)
  - ✓ Info message (blue)

**Expected Result:**  
All prompts work correctly, colors display properly, keyboard navigation smooth.

---

### 3. Progress Bar Visual Verification

**File:** Already tested in `test-all.js`, but verify visually

**Steps:**
1. Run the progress bar test again:
   ```bash
   cd cli
   node test-progress-bar.js
   ```

2. Observe the animations:
   - ✓ Progress bar fills smoothly from 0% → 100%
   - ✓ Percentage increases (2%, 6%, 9%, etc.)
   - ✓ Current file name displays (currentFile: file-XX.jpg)
   - ✓ ETA decreases (5s → 4s → 3s → 2s → 1s → 0s)
   - ✓ Spinner rotates smoothly (⠋ ⠙ ⠹ ⠸ ⠼ ⠴ ⠦ ⠧ ⠇ ⠏)
   - ✓ "Done in Xs" message appears after timed operation

**Expected Result:**  
All animations smooth, no flickering or text corruption.

---

### 4. File Finder Edge Cases

**Steps:**
1. Create the edge case test file:
   ```bash
   cd cli
   node test-file-finder-edge-cases.js
   ```

**Create this test file first:**
```javascript
import { findFilesByName, findFilesByPattern } from './shared/file-finder.js'

console.log('Testing File Finder Edge Cases...\n')

// Test 1: Non-existent file
console.log('1. Searching for non-existent file...')
const notFound = await findFilesByName('this-file-does-not-exist.xyz')
console.log(`  ✓ Found ${notFound.length} files (expected: 0)`)

// Test 2: Case insensitivity
console.log('\n2. Testing case insensitivity...')
const lowerCase = await findFilesByName('readme.md')
const upperCase = await findFilesByName('README.MD')
console.log(`  ✓ Lowercase: ${lowerCase.length} files`)
console.log(`  ✓ Uppercase: ${upperCase.length} files`)
console.log(`  ✓ Same result: ${lowerCase.length === upperCase.length}`)

// Test 3: Pattern with wildcards
console.log('\n3. Testing pattern with wildcards...')
const allMarkdown = await findFilesByPattern('**/*.md')
console.log(`  ✓ Found ${allMarkdown.length} .md files`)

// Test 4: Exclude patterns (node_modules should be excluded)
console.log('\n4. Verifying exclusions...')
const allFiles = await findFilesByPattern('**/*')
const hasNodeModules = allFiles.some(f => f.includes('node_modules'))
console.log(`  ✓ node_modules excluded: ${!hasNodeModules}`)

console.log('\n✓ Edge case tests complete')
```

**Expected Results:**
- ✓ Non-existent file returns empty array
- ✓ Case-insensitive search works
- ✓ Wildcards work correctly
- ✓ node_modules is excluded from results

---

### 5. Export Loader with Real Files

**Steps:**
1. Test with actual SnapSpot export file:
   ```bash
   cd cli
   node test-export-loader-real.js
   ```

**Create this test file first:**
```javascript
import { loadExportFile, getExportSummary } from './shared/export-loader.js'

console.log('Testing Export Loader with Real File...\n')

const testFile = '../core/formats/snapspot/__tests__/fixtures/full-export.json'

console.log(`Loading: ${testFile}`)
const exportData = await loadExportFile(testFile)

console.log('\nExport Summary:')
const summary = getExportSummary(exportData)
console.log(`  Map Name: ${summary.mapName}`)
console.log(`  Markers: ${summary.markerCount}`)
console.log(`  Photos: ${summary.photoCount}`)
console.log(`  Has Embedded Photos: ${summary.hasEmbeddedPhotos}`)
console.log(`  Photo Filenames: ${summary.photoFilenames.slice(0, 3).join(', ')}${summary.photoFilenames.length > 3 ? '...' : ''}`)

console.log('\n✓ Real file loaded successfully')
```

**Expected Results:**
- ✓ File loads without errors
- ✓ Map name displays correctly
- ✓ Marker and photo counts accurate
- ✓ Embedded photo detection works

---

### 6. Cross-Platform Path Testing (Windows Specific)

**Note:** You're on Windows, so verify path handling works correctly.

**Steps:**
1. Create path test file:
   ```bash
   cd cli
   node test-windows-paths.js
   ```

**Create this test file first:**
```javascript
import { findFilesByName } from './shared/file-finder.js'
import path from 'path'

console.log('Testing Windows Path Handling...\n')

// Test 1: Backslash paths
console.log('1. Testing backslash paths...')
const results = await findFilesByName('.gitignore')
results.forEach(file => {
  console.log(`  Found: ${file}`)
  const normalized = path.normalize(file)
  console.log(`  Normalized: ${normalized}`)
})

// Test 2: Verify cross-platform path.join usage
console.log('\n2. Testing path.join...')
const joinedPath = path.join('cli', 'shared', 'file-finder.js')
console.log(`  path.join result: ${joinedPath}`)
console.log(`  ✓ Uses correct separator: ${joinedPath.includes(path.sep)}`)

console.log('\n✓ Windows path tests complete')
```

**Expected Results:**
- ✓ Paths use correct Windows separators (`\`)
- ✓ No mixed forward/backward slashes
- ✓ path.join produces correct Windows paths

---

## Phase 7A Acceptance Criteria

All of the following must pass:

### Automated Tests
- [x] File Finder tests pass
- [x] Export Loader tests pass
- [x] Export Writer tests pass (transformations)
- [x] Progress Bar tests pass
- [x] Report Generator tests pass

### Manual Tests
- [ ] HTML report renders correctly in browser
- [ ] Interactive prompts work with keyboard navigation
- [ ] Progress bars animate smoothly
- [ ] File finder handles edge cases
- [ ] Export loader works with real files
- [ ] Windows path handling correct

### Code Quality
- [x] StandardJS linting passes (0 errors)
- [x] All functions have JSDoc documentation
- [x] README.md comprehensive and accurate

### Documentation
- [x] cli/README.md complete with all shared utilities documented
- [x] Each utility has usage examples
- [x] Installation instructions clear

---

## Known Limitations

1. **Export Writer Blob Handling:** Full `writeExportFile()` tests with image Blobs are skipped in Node.js environment due to browser/Node.js Blob incompatibility. This is acceptable because:
   - The actual CLI tools (Phase 7B-7D) will work with JSON files containing base64 strings
   - Transformation functions (removePhotos, renameMap, setCustomMetadata) are fully tested
   - JSON serialization/deserialization verified
   
2. **Interactive Prompts:** Cannot be fully automated, require manual keyboard interaction.

---

## Troubleshooting

### Issue: `npm install` fails
**Solution:** Verify Node.js 18+ installed: `node --version`

### Issue: Tests run but animations don't show
**Solution:** Ensure terminal supports ANSI escape codes (Windows Terminal recommended, not CMD)

### Issue: HTML report doesn't render styles
**Solution:** Check that file opened in browser (not text editor)

### Issue: File paths show forward slashes on Windows
**Solution:** Verify using `path.join()` instead of string concatenation

---

## Next Steps

Once all manual tests pass:
1. Mark all checkboxes above as complete
2. document any issues encountered
3. Proceed to **Phase 7B: Photo Finder Tool** (`docs/PHASE_7B_PHOTO_FINDER.md`)

---

**Testing Date:** _______________  
**Tester:** _______________  
**Results:** Pass / Fail (circle one)  
**Notes:**

